2026-02-06
- Initialized workflow files.
- Added Codex CLI hooks to ralph scripts (CODEX_BIN/CODEX_MODEL/CODEX_PROMPT_FLAG).
- Added ralph/current-issue.txt support and a ralph-run-all script with model selection.
- Added model_reasoning_effort wiring and defaults for effort tiers.
- Updated Ralph prompt to enforce agent-picked task, risk priority, quality bar, and commit-per-iteration.
- Simplified ralph-run-all to an AFK loop with fixed iterations and effort defaults.
- #37: Hardened proxy run_shell validation with allowlist/denylist + network disabled by default (override via PROXY_ALLOW_NETWORK=1). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/constants.ts, ts_glm/src/proxy/handler.ts, ts_glm/src/proxy/tools/shellSafety.ts, ts_glm/tests/shell-safety.test.ts.
- #38: Gated network tools (webfetch/web_search) behind PROXY_ALLOW_WEB_SEARCH=1 (filtered from tool prompt + blocked tool calls when disabled). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/constants.ts, ts_glm/src/proxy/handler.ts, ts_glm/src/proxy/tools/registry.ts, ts_glm/tests/network-tools.test.ts.
- #36: Tightened proxy path safety by blocking absolute paths and reducing sensitive-path false positives (allow .env.example/.env.sample/.env.template/.env.dist; avoid matching "monkey"/"hockey" via overly-broad key substring). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/handler.ts, ts_glm/src/proxy/tools/infer.ts, ts_glm/src/proxy/tools/pathSafety.ts, ts_glm/tests/path-safety.test.ts.
- #32: Enforced a confirmation boundary for mutation tools by truncating planner outputs to a single action whenever a mutation tool appears (prompt guidance + server-side guard). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/handler.ts, ts_glm/src/proxy/messages.ts, ts_glm/tests/mutation-boundary.test.ts.
- #34: Stopped inferring/repairing missing path/filePath for mutation tools (no heuristic mutations); only read tool calls may be repaired from recent conversation. Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/handler.ts, ts_glm/tests/filepath-repair.test.ts.
- #35: Bounded raw tool_calls count using PROXY_MAX_ACTIONS_PER_TURN (same limit as planner actions). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/handler.ts, ts_glm/tests/raw-tool-calls-limit.test.ts.
- #33: Made too_many_actions recoverable by truncating excess planner actions and tool_calls to PROXY_MAX_ACTIONS_PER_TURN (instead of blocking). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/handler.ts, ts_glm/tests/raw-tool-calls-limit.test.ts.
- #20: Reduced redundant chat-history round trips by skipping getCurrentMessageId preflight when includeHistory=true (GLMClient already fetches chat history in that mode). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/messages.ts, ts_glm/tests/history-roundtrips.test.ts.
- #21: Reduced planner retry round trips by resolving parentMessageId once per turn and reusing it across planner retries (avoids repeated getCurrentMessageId/getChat preflights). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/handler.ts, ts_glm/src/proxy/messages.ts, ts_glm/tests/planner-retry-roundtrips.test.ts.
- #22: Cached tool prompt rendering and removed redundant message conversion in the tool-result + history path (stats now match the prompt actually sent). Tests: npm --prefix ts_glm test.
  Files: ts_glm/src/proxy/handler.ts, ts_glm/src/proxy/messages.ts.
